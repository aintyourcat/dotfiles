#!/usr/bin/env bash

# Choose an option
options=(
    'Quit\0icon\x1fsystem-log-out-symbolic'
    'Refresh\0icon\x1fview-refresh-symbolic'
    'Reboot\0icon\x1fsystem-reboot-symbolic'
    'Shutdown\0icon\x1fsystem-shutdown-symbolic'
)

function choose () {
    test "$#" -eq 0 && return 1

    chosen=$(
        printf "%b\n" "$@" | \
        rofi -dmenu \
            -theme-str 'inputbar {enabled: false;}' \
            -theme-str "listview {border: 0; lines: "$#";}" \
    )

    echo "$chosen"
}

chosen=$(choose "${options[@]}")

# Confirm chosen option
if [ -n "$chosen" ]; then
    options=(
        'No\0icon\x1fwindow-close-symbolic'
        'Yes\0icon\x1fobject-select-symbolic'
    )

    answer="$(choose "${options[@]}")"

    if [ -n "$answer" ] && [ "$answer" = "Yes" ]; then
        case "$chosen" in
            Shutdown) sudo poweroff ;;
            Reboot) sudo reboot ;;
            Refresh) wm restart ;;
            Quit) wm quit ;;
        esac
    fi
fi
