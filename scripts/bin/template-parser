#!/bin/sh

readonly TEMPLATE_DIR="$XDG_CONFIG_HOME/template"

parse () {
    test ! -f "$1" && return
    test -z "$2" && return

    test -f "$2" && read -p "File '$2' exists, overwrite it? " answer
    case "$answer" in [!yY]*) return ;; esac

    . $(command -v colors)

    sed \
        -e "s/FOREGROUND/$FOREGROUND/g" \
        -e "s/BACKGROUND/$BACKGROUND/g" \
        -e "s/BLACK/$BLACK/g" \
        -e "s/DARK_GREY/$DARK_GREY/g" \
        -e "s/DARK_RED/$DARK_RED/g" \
        -e "s/RED/$RED/g" \
        -e "s/DARK_GREEN/$DARK_GREEN/g" \
        -e "s/GREEN/$GREEN/g" \
        -e "s/DARK_YELLOW/$DARK_YELLOW/g" \
        -e "s/YELLOW/$YELLOW/g" \
        -e "s/DARK_BLUE/$DARK_BLUE/g" \
        -e "s/BLUE/$BLUE/g" \
        -e "s/DARK_MAGENTA/$DARK_MAGENTA/g" \
        -e "s/MAGENTA/$MAGENTA/g" \
        -e "s/DARK_CYAN/$DARK_CYAN/g" \
        -e "s/CYAN/$CYAN/g" \
        -e "s/GREY/$GREY/g" \
        -e "s/WHITE/$WHITE/g" \
        "$1" > "$2"
}

if [ -n "$1" ] && [ -n "$2" ]; then
    parse "$1" "$2"
else
    parse "$TEMPLATE_DIR/dunstrc" "$XDG_CONFIG_HOME/dunst/dunstrc"
    parse "$TEMPLATE_DIR/square.rasi" "$XDG_CONFIG_HOME/rofi/square.rasi"
fi
