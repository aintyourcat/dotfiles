#!/bin/sh

# These envs needed by cron to show the notification
export XAUTHORITY=/run/user/1000/Xauthority
export DISPLAY=:0

# Get battery's status and capacity
read status < /sys/class/power_supply/BAT0/status
read capacity < /sys/class/power_supply/BAT0/capacity

# If discharging
if [ "$status" != "Charging" ]; then
    if [ $capacity -le 50 ]; then
        # If capacity is lower than or equals to 50, show notification
	    notify-send "$capacity%" 'Battery is low!' -i battery-empty
        # If capacity is lower or equals to 45, sleep the computer
	    [ $capacity -le 45 ] && xset dpms force off && sudo zzz
    fi
fi
