#!/bin/sh

. "$XDG_CONFIG_HOME/user-dirs.dirs"

dest_folder="$XDG_PICTURES_DIR/shots"

if [ ! -d "$dest_folder" ]; then
    mkdir -p "$dest_folder"
    if [ $? -ne 0 ]; then
        dest_folder="$HOME"
        notify-send 'Using $HOME folder'
    fi
fi

file_name='scrot-%m%d%Y-%H%M%S'
file_ext='png'
file_path="$dest_folder/$file_name.$file_ext"
copy_command='xclip -selection clipboard -t image/png $f'
quality=100
delay_count=3

case $1 in
    -s) scrot $file_path -q $quality -b -s -f -e "$copy_command; notify-send 'Selection taken!'" ;;
    -d) scrot $file_path -q $quality -d $delay_count -e "$copy_command; notify-send 'Delayed shot taken!'" ;;
    *) scrot $file_path -q $quality -e "$copy_command; notify-send 'Captured!'" ;;
esac
